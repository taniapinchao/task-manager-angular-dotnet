<div class="container py-5">

    <div class="text-center mb-5">
        <h1 class="display-4 fw-bold">Task Manager</h1>
        <p class="text-muted">Gestión de tareas con Angular 17 + .NET</p>
    </div>

    <!-- Botón abrir modal -->
    <div class="text-center mb-4">
        <button class="btn btn-lg btn-primary" data-bs-toggle="modal" data-bs-target="#modalTarea"
            (click)="abrirModalCrear()">
            <i class="bi bi-plus-circle me-2"></i> Nueva Tarea
        </button>
    </div>

    <!-- Modal reutilizable para crear/editar -->
    <div class="modal fade" id="modalTarea" tabindex="-1" aria-labelledby="modalTareaLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content shadow-lg border-0">
                <div class="modal-header" [ngClass]="isEditMode ? 'bg-warning text-dark' : 'bg-primary text-white'">
                    <h5 class="modal-title" id="modalTareaLabel">
                        <i class="bi" [ngClass]="isEditMode ? 'bi-pencil-square me-2' : 'bi-card-text me-2'"></i>
                        {{ isEditMode ? 'Editar Tarea' : 'Crear Nueva Tarea' }}
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="mb-3">
                            <label for="titulo" class="form-label fw-semibold">Título</label>
                            <input type="text" class="form-control form-control-lg" id="titulo"
                                [(ngModel)]="tareaModal.titulo" name="titulo" placeholder="Título de la tarea">
                        </div>
                        <div class="mb-3">
                            <label for="descripcion" class="form-label fw-semibold">Descripción</label>
                            <textarea class="form-control form-control-lg" id="descripcion"
                                [(ngModel)]="tareaModal.descripcion" name="descripcion" rows="3"
                                placeholder="Descripción"></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn" [ngClass]="isEditMode ? 'btn-warning' : 'btn-primary'"
                        (click)="guardarTarea()" data-bs-dismiss="modal">
                        <i class="bi" [ngClass]="isEditMode ? 'bi-pencil-square me-1' : 'bi-check-circle me-1'"></i>
                        {{ isEditMode ? 'Guardar Cambios' : 'Crear' }}
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Lista de tareas como tarjetas -->
    <div *ngIf="tasks().length === 0" class="alert alert-info text-center fs-5">
        <i class="bi bi-info-circle me-2"></i>No hay tareas aún.
    </div>

    <div *ngIf="tasks().length > 0" class="row g-4">
        <div *ngFor="let task of tasks()" class="col-md-6 col-lg-4">
            <div class="card shadow-sm h-100">
                <div class="card-body d-flex flex-column">
                    <h5 class="card-title fw-bold">{{ task.titulo }}</h5>
                    <p class="card-text text-muted mb-2">{{ task.descripcion }}</p>
                    <p class="text-secondary small mb-3">
                        {{ task.editada ? 'Editada: ' : 'Creada: ' }} {{ task.fechaCreacion | date:'short' }}
                    </p>
                    <span class="badge mb-3" [ngClass]="task.completada ? 'bg-success' : 'bg-danger'">
                        {{ task.completada ? '✔ Completada' : '✖ Pendiente' }}
                    </span>
                    <div class="mt-auto d-flex justify-content-between">
                        <button class="btn btn-sm btn-outline-info" data-bs-toggle="modal" data-bs-target="#modalTarea"
                            (click)="abrirModalEditar(task)">
                            <i class="bi bi-pencil-square me-1"></i> Editar
                        </button>
                        <button class="btn btn-sm btn-outline-danger"
                            (click)="task.id != null && eliminarTarea(task.id)">
                            <i class="bi bi-trash me-1"></i> Eliminar
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>